<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Next Chapter Hub - Interactive Bookstore Layout</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Visualization & Content Choices: 
        1. Bookstore Layout Zones -> Goal: Explore specific section details -> Presentation: Interactive grid cells (HTML/Tailwind divs) -> Interaction: Click to open modal with text descriptions and lists of features. Justification: Provides focused, contextual information for each part of the store.
        2. Overall Space Allocation -> Goal: Understand how space is broadly utilized -> Viz/Presentation: Doughnut Chart (Chart.js) showing % breakdown (Retail, Book Aisles, Experience Zones, Services). Interaction: Hover for tooltips. Justification: Offers a high-level quantitative summary of the layout's composition.
        3. Genre Spotlight (New) -> Goal: Provide dynamic, engaging summaries for book genres -> Viz/Presentation: Text generated by LLM -> Interaction: Button click within genre modal to trigger LLM call. Justification: Adds an AI-powered interactive element that enhances content exploration.
        CONFIRMATION: NO SVG/Mermaid. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .modal {
            transition: opacity 0.25s ease;
        }
        .modal-content {
            transition: transform 0.25s ease;
        }
        .map-zone {
            transition: background-color 0.3s ease, transform 0.2s ease;
        }
        .map-zone:hover {
            transform: translateY(-2px);
        }
        .chart-container { /* Styles for chart container as per requirements */
            position: relative; 
            width: 100%;
            margin-left: auto;
            margin-right: auto;
        }
        /* Custom scrollbar for modal content if needed */
        .modal-body::-webkit-scrollbar {
            width: 8px;
        }
        .modal-body::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        .modal-body::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 10px;
        }
        .modal-body::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap');
    </style>
</head>
<body class="bg-stone-100 text-stone-800">

    <header class="bg-teal-700 text-teal-50 py-6 shadow-lg">
        <div class="container mx-auto px-4">
            <h1 class="text-3xl md:text-4xl font-bold text-center">Next Chapter Hub</h1>
            <p class="text-lg md:text-xl text-center mt-2">Knowledge served without ads</p>
        </div>
    </header>

    <main class="container mx-auto p-4 md:p-8">
        
        <section id="introduction" class="mb-10 text-center bg-white p-6 rounded-lg shadow">
            <h2 class="text-2xl font-semibold text-teal-700 mb-3">Welcome!</h2>
            <p class="text-stone-700 leading-relaxed">
                This interactive application helps you visualize and understand the layout of our thoughtfully designed bookstore. 
                Click on any highlighted zone in the map below to learn more about its features, purpose, and the experiences it offers.
                This map is a conceptual representation, not a literal floor plan image.
                You can also see an overview of how space is allocated in the chart.
            </p>
        </section>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <div class="lg:col-span-2 bg-white p-6 rounded-lg shadow-xl">
                <h2 class="text-2xl font-semibold text-teal-700 mb-6 text-center">Bookstore Interactive Map üó∫Ô∏è</h2>
                <div id="bookstoreMap" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4 p-4 border border-teal-200 rounded-lg bg-amber-50 min-h-[400px]">
                </div>
            </div>

            <div class="bg-white p-6 rounded-lg shadow-xl">
                <h2 class="text-2xl font-semibold text-teal-700 mb-6 text-center">Space Allocation Overview</h2>
                <div class="chart-container max-w-sm h-72 sm:h-80 md:h-96 max-h-[450px]">
                    <canvas id="spaceAllocationChart"></canvas>
                </div>
                <p class="text-xs text-stone-500 mt-4 text-center">
                    This chart provides an estimated breakdown of how space is utilized across different types of zones within the bookstore.
                </p>
            </div>
        </div>
    </main>

    <footer class="bg-teal-700 text-teal-100 py-8 mt-12 text-center">
        <p>&copy; 2025 Next Chapter Hub. All rights reserved.</p>
        <p class="text-xs mt-1">Bringing clarity to bookstore layouts.</p>
    </footer>

    <div id="detailModal" class="modal fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 opacity-0 pointer-events-none z-50">
        <div class="modal-content bg-white rounded-lg shadow-2xl w-full max-w-lg max-h-[90vh] transform scale-95">
            <div class="flex justify-between items-center p-5 border-b border-stone-200">
                <h3 id="modalTitle" class="text-2xl font-semibold text-teal-700">Zone Details</h3>
                <button id="closeModal" class="text-stone-500 hover:text-orange-500 transition-colors text-2xl">&times;</button>
            </div>
            <div id="modalBody" class="p-6 modal-body overflow-y-auto" style="max-height: calc(90vh - 130px);">
                </div>
            <div id="llmFeatureArea" class="p-4 border-t border-stone-200 hidden">
                <button id="getGenreSpotlightBtn" class="bg-teal-600 hover:bg-teal-700 text-white font-semibold py-2 px-4 rounded-lg shadow transition-colors duration-300 ease-in-out w-full flex items-center justify-center">
                    <span id="llmBtnText">‚ú® Get Genre Spotlight</span>
                    <svg id="llmSpinner" class="animate-spin h-5 w-5 text-white ml-2 hidden" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                </button>
                <div id="llmResponse" class="mt-4 p-3 bg-amber-100 border border-amber-200 rounded-lg text-stone-800 text-sm hidden">
                    </div>
            </div>
            <div class="p-4 border-t border-stone-200 text-right">
                 <button id="closeModalFooter" class="bg-orange-500 hover:bg-orange-600 text-white font-semibold py-2 px-4 rounded-lg shadow transition-colors">Close</button>
            </div>
        </div>
    </div>

    <script>
        const bookstoreData = {
            entrance: {
                name: "Entrance & Welcome Area",
                icon: "üö™",
                bgColor: "bg-sky-200",
                hoverColor: "hover:bg-sky-300",
                description: "The first impression! This area is designed to draw customers in and provide immediate information.",
                features: [
                    "Outdoor Digital Display Screens: Showcasing events, promotions, and book trailers to attract passersby.",
                    "Indoor Digital Display Screen: Welcoming messages and daily specials.",
                    "Clear Signage for Main Entrance/Exit."
                ],
                relatedInfo: "Strategically placed to maximize visibility and foot traffic."
            },
            reception: {
                name: "Reception & Checkout",
                icon: "üí≥",
                bgColor: "bg-blue-200",
                hoverColor: "hover:bg-blue-300",
                description: "Central hub for customer service, purchases, and inquiries.",
                features: [
                    "Staffed Tills for personalized service.",
                    "Self-Checkout Kiosk for quick purchases.",
                    "Newsletter Sign-up / Volunteering Registration Tablet.",
                    "Information point for events and store layout."
                ],
                relatedInfo: "Positioned for easy access from the entrance and before exiting."
            },
            donationBox: {
                name: "Donation Box Area",
                icon: "üéÅ",
                bgColor: "bg-green-200",
                hoverColor: "hover:bg-green-300",
                description: "A dedicated spot for community contributions.",
                features: [
                    "Prominently placed Donation Box.",
                    "'Share the Joy of Reading' signage.",
                    "Information on where donated books go."
                ],
                relatedInfo: "Located near the entrance/exit for convenience."
            },
            miniRetail: {
                name: "Mini Retail Zone",
                icon: "üõçÔ∏è",
                bgColor: "bg-indigo-200",
                hoverColor: "hover:bg-indigo-300",
                description: "Curated selection of book-themed merchandise and gifts.",
                features: [
                    "Book-themed Mugs, Tote Bags, Bookmarks.",
                    "Candles, Tea, Stationery.",
                    "Ideal for impulse buys and gifting."
                ],
                relatedInfo: "Located near the checkout for visibility and last-minute purchases. A key revenue-generating add-on."
            },
            newReleases: {
                name: "New Releases Section",
                icon: "üåü",
                bgColor: "bg-yellow-200",
                hoverColor: "hover:bg-yellow-300",
                description: "Showcasing the latest and most anticipated books.",
                features: [
                    "Central display tables and prominent shelving.",
                    "Frequently updated with new arrivals.",
                    "Clearly labelled for easy Browse."
                ],
                relatedInfo: "Positioned near the front to capture immediate interest."
            },
            bestSellers: {
                name: "Best Sellers Section",
                icon: "üèÜ",
                bgColor: "bg-amber-200",
                hoverColor: "hover:bg-amber-300",
                description: "Highlighting popular books, both weekly and all-time favorites.",
                features: [
                    "Prominent shelving with clear categorization.",
                    "Displays for 'Weekly Top 10' and 'All-Time Classics'."
                ],
                relatedInfo: "High-traffic area, encouraging discovery of popular reads."
            },
            genreFiction: {
                name: "Genre Fiction Aisles",
                icon: "üìö",
                bgColor: "bg-purple-200",
                hoverColor: "hover:bg-purple-300",
                description: "Dedicated zones for various fiction genres, allowing for deep dives into specific interests.",
                features: [
                    "Sci-Fi & Fantasy",
                    "Romance",
                    "Graphic Novels & Manga",
                    "Young Adult (YA)"
                ],
                relatedInfo: "Clear signage (including floor graphics ‚û§) helps navigation. Each genre is a destination."
            },
            genreNonFiction: {
                name: "Genre Non-Fiction Aisles",
                icon: "üß†",
                bgColor: "bg-violet-200",
                hoverColor: "hover:bg-violet-300",
                description: "A wide array of non-fiction categories catering to diverse interests and learning needs.",
                features: [
                    "History & Politics",
                    "Biographies & Memoirs",
                    "Self-Help & Wellness",
                    "Business & Entrepreneurship",
                    "Education & Exam Prep"
                ],
                relatedInfo: "Organized for easy Browse and discovery within specific fields of interest."
            },
            lifestyle: {
                name: "Lifestyle & Hobbies",
                icon: "üé®",
                bgColor: "bg-fuchsia-200",
                hoverColor: "hover:bg-fuchsia-300",
                description: "Sections dedicated to practical skills, creative pursuits, and family life.",
                features: [
                    "Cookbooks & Food Culture",
                    "Hobbies & Crafts",
                    "Parenting & Family"
                ],
                relatedInfo: "Often grouped together to cater to home and family interests."
            },
            kidsZone: {
                name: "Kids' Zone Revamp",
                icon: "üßí",
                bgColor: "bg-pink-200",
                hoverColor: "hover:bg-pink-300",
                description: "A vibrant and engaging space designed specifically for young readers and their families.",
                features: [
                    "Comfortable Story Corner for readings and events.",
                    "Coloring Station with supplies.",
                    "Book-themed Toy Shelf (items for sale).",
                    "Age-appropriate shelving and displays."
                ],
                relatedInfo: "An important experience-focused upgrade to make the store family-friendly."
            },
            communityWall: {
                name: "Community Wall",
                icon: "üó£Ô∏è",
                bgColor: "bg-rose-200",
                hoverColor: "hover:bg-rose-300",
                description: "A space for customers and the local community to connect and share.",
                features: [
                    "Pinned customer reviews and book recommendations.",
                    "Children's drawings and artwork.",
                    "Features on local authors and events."
                ],
                relatedInfo: "Often located near the Kids' Zone or Reading Lounge to foster a sense of community."
            },
            readingLounge: {
                name: "Reading Lounge Zone",
                icon: "üõãÔ∏è",
                bgColor: "bg-lime-200",
                hoverColor: "hover:bg-lime-300",
                description: "A comfortable and quiet area for customers to relax, read, and browse books before purchasing.",
                features: [
                    "Comfortable Sofas and Armchairs.",
                    "Ambient Lamps for good lighting.",
                    "Free Water Station.",
                    "Designated Quiet Area."
                ],
                relatedInfo: "Enhances the customer experience, encouraging longer stays."
            },
            wallOfFame: {
                name: "Wall of Fame",
                icon: "üåü",
                bgColor: "bg-emerald-200",
                hoverColor: "hover:bg-emerald-300",
                description: "Celebrating readers and recommendations within the bookstore community.",
                features: [
                    "'Top Readers of the Month' recognition.",
                    "'Staff Favorites' displays.",
                    "'Your Next Favorite Read' interactive ladder or display."
                ],
                relatedInfo: "Adds a personal touch and encourages engagement."
            },
            localAuthors: {
                name: "Local Authors (Tasmanian Section)",
                icon: "üñãÔ∏è",
                bgColor: "bg-cyan-200",
                hoverColor: "hover:bg-cyan-300",
                description: "A dedicated section showcasing and supporting literary talent from Tasmania.",
                features: [
                    "Dedicated display for books by local authors.",
                    "Information about Tasmanian writers and literary events.",
                    "Potential for consignment sales or local author spotlights."
                ],
                relatedInfo: "A unique selling proposition and community engagement feature."
            },
            printCopyServices: {
                name: "Print & Copy Services",
                icon: "üì†",
                bgColor: "bg-slate-300",
                hoverColor: "hover:bg-slate-400",
                description: "Convenient self-service facilities for printing and copying needs.",
                features: [
                    "1-2 Self-service Printers.",
                    "Scanners.",
                    "Email-to-print or QR code upload system."
                ],
                relatedInfo: "A revenue-generating add-on attracting students, professionals, and general public."
            },
            photoStation: {
                name: "Photo Printing Station",
                icon: "üì∏",
                bgColor: "bg-gray-300",
                hoverColor: "hover:bg-gray-400",
                description: "Self-service kiosk for quick and easy photo printing.",
                features: [
                    "Prints 4x6 photos.",
                    "ID photo services.",
                    "Passport photo services (check regulations)."
                ],
                relatedInfo: "Another revenue stream, promoted with slogans like 'Grab a Book & a Passport Photo'."
            }
        };

        const mapContainer = document.getElementById('bookstoreMap');
        const modal = document.getElementById('detailModal');
        const modalTitle = document.getElementById('modalTitle');
        const modalBody = document.getElementById('modalBody');
        const closeModalButton = document.getElementById('closeModal');
        const closeModalFooterButton = document.getElementById('closeModalFooter');
        const llmFeatureArea = document.getElementById('llmFeatureArea');
        const getGenreSpotlightBtn = document.getElementById('getGenreSpotlightBtn');
        const llmBtnText = document.getElementById('llmBtnText');
        const llmSpinner = document.getElementById('llmSpinner');
        const llmResponse = document.getElementById('llmResponse');

        // Define which zones are considered 'genres' for the LLM feature
        const genreZones = ['genreFiction', 'genreNonFiction', 'lifestyle'];

        async function generateGeminiResponse(genreName) {
            llmBtnText.textContent = 'Generating...';
            llmSpinner.classList.remove('hidden');
            getGenreSpotlightBtn.disabled = true;
            llmResponse.classList.add('hidden'); // Hide previous response
            llmResponse.textContent = ''; // Clear previous response

            let chatHistory = [];
            const prompt = `Provide a brief, engaging spotlight summary for the "${genreName}" genre, highlighting its appeal and a typical theme, suitable for a bookstore display. Keep it concise, around 50-70 words.`;
            chatHistory.push({ role: "user", parts: [{ text: prompt }] });
            const payload = { contents: chatHistory };
            const apiKey = ""; // If you want to use models other than gemini-2.0-flash or imagen-3.0-generate-002, provide an API key here. Otherwise, leave this as-is.
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                const result = await response.json();

                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    const text = result.candidates[0].content.parts[0].text;
                    llmResponse.textContent = text;
                    llmResponse.classList.remove('hidden');
                } else {
                    llmResponse.textContent = 'Could not generate a spotlight for this genre. Please try again.';
                    llmResponse.classList.remove('hidden');
                    console.error('Gemini API response structure unexpected:', result);
                }
            } catch (error) {
                llmResponse.textContent = 'Error generating spotlight. Please check your connection.';
                llmResponse.classList.remove('hidden');
                console.error('Error calling Gemini API:', error);
            } finally {
                llmBtnText.textContent = '‚ú® Get Genre Spotlight';
                llmSpinner.classList.add('hidden');
                getGenreSpotlightBtn.disabled = false;
            }
        }

        function openModal(zoneKey) {
            const zone = bookstoreData[zoneKey];
            if (!zone) return;

            modalTitle.textContent = `${zone.icon} ${zone.name}`;
            
            let featuresHTML = '';
            if (zone.features && zone.features.length > 0) {
                featuresHTML = `<h4 class="font-semibold text-lg text-teal-600 mt-4 mb-2">Key Features:</h4><ul class="list-disc list-inside space-y-1 text-stone-700">`;
                zone.features.forEach(feature => {
                    featuresHTML += `<li>${feature}</li>`;
                });
                featuresHTML += `</ul>`;
            }

            let relatedInfoHTML = '';
            if (zone.relatedInfo) {
                relatedInfoHTML = `<h4 class="font-semibold text-lg text-teal-600 mt-4 mb-2">Additional Notes:</h4><p class="text-stone-700 italic">${zone.relatedInfo}</p>`;
            }
            
            modalBody.innerHTML = `
                <p class="text-stone-700 leading-relaxed mb-4">${zone.description}</p>
                ${featuresHTML}
                ${relatedInfoHTML}
            `;

            // LLM Feature Integration
            if (genreZones.includes(zoneKey)) {
                llmFeatureArea.classList.remove('hidden');
                getGenreSpotlightBtn.onclick = () => generateGeminiResponse(zone.name);
                llmResponse.classList.add('hidden'); // Hide previous response
                llmResponse.textContent = ''; // Clear previous response
                llmBtnText.textContent = '‚ú® Get Genre Spotlight'; // Reset button text
                llmSpinner.classList.add('hidden'); // Hide spinner
                getGenreSpotlightBtn.disabled = false; // Enable button
            } else {
                llmFeatureArea.classList.add('hidden');
            }
            
            modal.classList.remove('opacity-0', 'pointer-events-none');
            modal.querySelector('.modal-content').classList.remove('scale-95');
            modal.querySelector('.modal-content').classList.add('scale-100');
        }

        function closeModal() {
            modal.classList.add('opacity-0');
            modal.querySelector('.modal-content').classList.add('scale-95');
            modal.querySelector('.modal-content').classList.remove('scale-100');
            setTimeout(() => { // Wait for transition to finish before hiding
                 modal.classList.add('pointer-events-none');
            }, 250);
        }

        closeModalButton.addEventListener('click', closeModal);
        closeModalFooterButton.addEventListener('click', closeModal);
        modal.addEventListener('click', (event) => {
            if (event.target === modal) {
                closeModal();
            }
        });
        document.addEventListener('keydown', (event) => {
            if (event.key === 'Escape') {
                closeModal();
            }
        });

        Object.keys(bookstoreData).forEach(key => {
            const zone = bookstoreData[key];
            const zoneDiv = document.createElement('div');
            zoneDiv.className = `map-zone p-3 md:p-4 rounded-lg shadow text-center cursor-pointer flex flex-col justify-center items-center aspect-square ${zone.bgColor} ${zone.hoverColor} text-stone-700`;
            zoneDiv.innerHTML = `
                <span class="text-3xl md:text-4xl mb-1">${zone.icon}</span>
                <span class="text-xs sm:text-sm font-semibold">${zone.name.split(" ")[0]} ${zone.name.split(" ")[1] || ""}</span>`;
            zoneDiv.addEventListener('click', () => openModal(key));
            mapContainer.appendChild(zoneDiv);
        });

        const spaceAllocationCtx = document.getElementById('spaceAllocationChart').getContext('2d');
        new Chart(spaceAllocationCtx, {
            type: 'doughnut',
            data: {
                labels: ['Book Display & Sales', 'Experience & Community', 'Retail & Checkout', 'Services & Utilities'],
                datasets: [{
                    label: 'Space Allocation',
                    data: [50, 25, 15, 10], // Approximate percentages
                    backgroundColor: [
                        'rgba(13, 148, 136, 0.7)', // teal-600
                        'rgba(249, 115, 22, 0.7)', // orange-500
                        'rgba(59, 130, 246, 0.7)', // blue-500
                        'rgba(107, 114, 128, 0.7)'  // gray-500
                    ],
                    borderColor: [
                        'rgba(13, 148, 136, 1)',
                        'rgba(249, 115, 22, 1)',
                        'rgba(59, 130, 246, 1)',
                        'rgba(107, 114, 128, 1)'
                    ],
                    borderWidth: 1,
                    hoverOffset: 8
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom',
                        labels: {
                            padding: 15,
                            font: {
                                size: 12,
                                family: 'Inter'
                            },
                            color: '#374151' // stone-700
                        }
                    },
                    tooltip: {
                        enabled: true,
                        backgroundColor: 'rgba(0,0,0,0.75)',
                        titleFont: { size: 14, family: 'Inter', weight: 'bold' },
                        bodyFont: { size: 12, family: 'Inter' },
                        callbacks: {
                            label: function(context) {
                                let label = context.label || '';
                                if (label) {
                                    label += ': ';
                                }
                                if (context.parsed !== null) {
                                    label += context.parsed + '%';
                                }
                                return label;
                            }
                        }
                    }
                }
            }
        });
    </script>
</body>
</html>
